<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="home.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Syncopate" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Caveat" rel="stylesheet">

    <link rel="icon" type="image/png" href="tab_logo.png" />

    <title>Elsilias Kitchen</title>

    <script src="debug.js"></script>
    <script src="home_script.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.3/jspdf.umd.min.js"></script>
</head>

<body class="back_dn">

    
<div id="loading_div">
    <svg id="loading_E_id" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
        <path fill="#D35A21"
            d="M10,40 A30,30 0 0 1 40,10 L90,10 L90,30 L40,30 A10,10 0 0 0 30,40 L85,40 L85,60 L30,60 A10,10 0 0 0 40,70 L90,70 L90,90 L40,90 A30,30 0 0 1 10,60 Z"
        />
    </svg>
    <svg id="loading_K_id" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
        <polygon points="10,10 30,10 30,40 40,40 65,10 91,10 55,50 91,90 65,90 40,60 30,60 30,90 10,90" fill="#D35A21"></polygon>
    </svg>
</div>
    <script>
          if(DEBUG_MODE == DEBUG.YES){
            document.getElementById('loading_div').style.display='none';
          }
          else{
            createLoadingScreen();
          }

        //refresh content
        function changeLanguage() {
            isSpanish = !isSpanish;
            document.querySelectorAll('.lang_slide').forEach(ball => {
                        ball.classList.toggle("changeLang");
            });
            updateLayout();
        }

        // let shadow_class_for_cir_nav = undefined;
        
            let night = false;

        function changeNightMode(){
            document.querySelectorAll('.dn_slide').forEach(ball => {
                ball.classList.toggle("changeNight");
                if(ball.classList.contains("changeNight"))
                    night = true;
                else
                    night = false;
            });

            // const backDarkColor = "#191919";
            const backDarkColor = "#202020";
            // const backLightColor = "#ECECEC";
            const backLightColor = "white";
            const textDarkColor = "black";
            // const textLightColor = "white";
            const textLightColor = "rgba( 255, 255, 255,0.8)";
            

            const switchDarkColor = "#454545";
            const switchLightColor = "#404040";                     

            // NIGHT MODE
            if(night){

                //side menu - night
                document.getElementById('side_menu').classList.remove('side_menu_div_shadowDay');
                document.getElementById('side_menu').classList.add('side_menu_div_shadowNight');

                //cart number - night
                document.getElementById('cart_num_id').style.border=`1px solid ${backDarkColor}`;
                
                //titles - night
                document.querySelectorAll(".text_dn").forEach(title =>{
                    title.style.color=textLightColor;
                });
                                
                //container_slider
                document.querySelectorAll(".switch_dn").forEach(container =>{
                    container.style.backgroundColor= switchDarkColor;
                });


                
                //cir_nav night
                window.dispatchEvent(new Event('scroll'));

                //cartContent night
                document.querySelector(".cartContent").style.boxShadow ='-1px 0px 20px rgba(255, 255, 255, 0.3)';
          
                //backgrounds - night
                document.querySelectorAll(".back_dn").forEach(backgrounds =>{
                    backgrounds.style.backgroundColor=backDarkColor;
                });

                //cart icon - night
                 document.querySelector(".cart_icon").style.color=textLightColor;
                
                //banner - night
                 document.querySelector(".banner").style.opacity="0.7";
                                
                // document.getElementById('side_menu').style.backgroundColor=`black`;
              
                
            }
            // DAY MODE
            else{

                //side menu - day
                document.getElementById('side_menu').classList.remove('side_menu_div_shadowNight');
                document.getElementById('side_menu').classList.add('side_menu_div_shadowDay');

                //cart number - day
                document.getElementById('cart_num_id').style.border=`1px solid ${backLightColor}`;

                //titles - day
                 document.querySelectorAll(".text_dn").forEach(title =>{
                    title.style.color="black";
                });

                //container_slider - day
                document.querySelectorAll(".switch_dn").forEach(container =>{
                    container.style.backgroundColor=switchLightColor;
                });

                  //cir_nav - day
                  window.dispatchEvent(new Event('scroll'));

                   //cartContent - day
                document.querySelector(".cartContent").style.boxShadow ='-1px 0px 20px rgba(0, 0, 0, 0.3)';


                 //backgrounds - day
                document.querySelectorAll(".back_dn").forEach(backgrounds =>{
                    backgrounds.style.backgroundColor=backLightColor;
                });

                 //cart icon - day
                 document.querySelector(".cart_icon").style.color="black";

                //banner - day
                 document.querySelector(".banner").style.opacity="1";
                
            }
            
            if(savedMessage != undefined){
                document.getElementById("add_message").style.color="#4091ee";
            }

        }
    </script>

    <script>



    window.addEventListener('resize', function (e) {
        // try{
        if(document.getElementById('side_menu') && document.getElementById('side_menu').classList.contains('showMenu'))
            document.getElementById('side_menu').classList.remove('showMenu');

        if(document.getElementById('payment_menu_id') && document.getElementById('payment_menu_id').classList.contains('showMenu'))
            document.getElementById('payment_menu_id').classList.remove('showMenu');

        if(document.getElementById('payment_id') && document.getElementById('payment_id').classList.contains('showPayment'))
            document.getElementById('payment_id').classList.remove('showPayment');
        
            document.body.style.overflow = "";
        // }
        // catch(e){
        //     console.log(e);
        // }
    });



        let isSpanish = false;


     window.addEventListener('beforeunload', function (e) {
        if(cart.length > 0 && DEBUG_MODE == DEBUG.NO){
            
            // i believe this is needed for modern browsers
            e.preventDefault(); 

            //chrome requires the returnValue to be set (this is for old browsers)
            e.returnValue = 'Cart is not empty. Are you sure you want to leave?'; 
        }
    });

        let cart = [];

        function addToCart(id, name, sp_name, image, pan_size, price, cart_button, fullpan, halfpan) {

            if (pan_size === 2)
                id += 10000;

            if (cart.find(i => i.id === id))
                return false;
            
            cart.push({id, name, sp_name, image, quantity: 1, pan_size, price, cart_button, fullpan, halfpan});

            return true;
        }


        function clearFromCart(id) {

            const cart_item = cart.find(i => i.id === id);
            if (cart_item) {

                //remove item from cart
                cart = cart.filter(i => i.id !== id);
                renderCart();
                updateTotal();
                
                //change add to cart icon if needed
                if(cart_item.cart_button.classList.contains('itemWasAdded'))
                    if((cart_item.pan_size == 1 && cart_item.fullpan.classList.contains('active')) || (cart_item.pan_size == 2 && cart_item.halfpan.classList.contains('active')))                        
                        cart_item.cart_button.classList.toggle('itemWasAdded');
                
                return true;
            }

            return false;
        }

    </script>

    <script>
        function openCartContents() {

            //close message box if open
            if(document.getElementById("saveContainerId").classList.contains("show"))
                document.getElementById("saveContainerId").classList.toggle("show");
        

            document.querySelector('.cart').classList.toggle('open');
            // if(document.querySelector('.cart').classList.contains('open'))
            //      document.body.style.overflow = "hidden";
            // else
            //      document.body.style.overflow = "";
            
                if (cart.length === 0) {

                    document.getElementById('add_message').style.display = 'none';
                    document.getElementById('nothing_in_cart').style.display = 'block';
                    document.getElementById('cartItemsId').style.display = 'none';
                    document.getElementById('checkoutBtn').classList.remove('enabled');


                } else {
                    document.getElementById('add_message').style.display = 'block';
                    document.getElementById('nothing_in_cart').style.display = 'none';
                    document.getElementById('cartItemsId').style.display = 'block';
                    document.getElementById('checkoutBtn').classList.add('enabled');

                }
        }
    </script>

    <script>

        function updateTotal() {
            let newTotal = 0;
            let cartCounter = 0;
            cart.forEach(item => {
                newTotal += item.quantity * item.price;
                cartCounter += item.quantity;
            });

            document.getElementById('total_of_order_id').innerHTML = `Total: $${newTotal}`;

            if (cart.length != 0) {
                document.getElementById('cart_num_id').innerHTML = cartCounter;
                document.getElementById('checkoutBtn').classList.add('enabled');
            }
            else {
                document.getElementById('cart_num_id').style.display = 'none';
                document.getElementById('add_message').style.display = 'none';
                document.getElementById('nothing_in_cart').style.display = 'block';
                document.getElementById('cartItemsId').style.display = 'none';
                document.getElementById('checkoutBtn').classList.remove('enabled');

                return;
            }

        }

        function renderCart() {
            if (cart.length == 0){
                document.getElementById("textareaId").value = '';
                document.getElementById("saveMessageButtonId").style='background-olor:rgba(57, 57, 57, 0.545);';
                savedMessage = undefined;
                document.getElementById("add_message").style.color="black";
                document.getElementById('add_message').style.display = 'none';
                document.getElementById('nothing_in_cart').style.display = 'block';
                document.getElementById('cartItemsId').style.display = 'none';
                document.getElementById('checkoutBtn').classList.remove('enabled');
                updateTotal();
                return;
            }

            const cartDiv = document.getElementById('cartItemsId');
            cartDiv.innerHTML = ''; // clear old items

            cart.forEach(item => {

                // Create the outer container
                let container = document.createElement('div');
                container.className = "cartItemContainter text_dn";

                // Left picture div
                let left = document.createElement('div');
                left.className = 'leftpic';

                let img = document.createElement('img');
                img.src = item.image;
                img.alt = item.name;

                let img2 = document.createElement('img');
                img2.src = item.image;

                if (item.pan_size == 2) {
                    img2.classList.add('blurred');
                    left.appendChild(img2);
                }
                left.appendChild(img);

                // Right name/qty div
                let right = document.createElement('div');
                right.className = 'rightname text_dn';
                right.style.position = "relative";

                if(night)
                    right.style.color = "rgba(255, 255, 255,0.8)";
                else
                    right.style.color = "black";


                let nameP = document.createElement('p');
                nameP.textContent = item.name;

                let pane_size = document.createElement('p');
                pane_size.classList.add('pan_text');

                //SPANISH
                if (isSpanish) {
                    if((item.id >= 700 && item.id < 800) || (item.id >= 10700 && item.id < 10800))//if pasteles
                        pane_size.textContent = item.pan_size == 2 ? "Media Dozena" : "Dozena";
                    else
                        pane_size.textContent = item.pan_size == 2 ? "Media Bandeja" : "Bandeja Entera";
                }
                else{//ENGLISH
                    if((item.id >= 700 && item.id < 800) || (item.id >= 10700 && item.id < 10800 ))
                        pane_size.textContent = item.pan_size == 2 ? "Half Dozen" : "Dozen";
                    else
                        pane_size.textContent = item.pan_size == 2 ? "Half Pan" : "Full Pan";
                }
                nameP.textContent = item.sp_name;


                let qtyP = document.createElement('p');
                qtyP.style.fontSize = "14px";
                qtyP.style.position = "absolute";
                qtyP.style.bottom = "0";
                if (isSpanish)
                    qtyP.textContent = `Cantidad: ${item.quantity}`;
                else
                    qtyP.textContent = `Quantity: ${item.quantity}`;

                const cartMinusSign = document.createElement('span');
                cartMinusSign.className = 'cartMinusSign text_dn';
                cartMinusSign.textContent = '\u2212';

                const cartTrashIcon = document.createElement('span');
                cartTrashIcon.className = 'material-symbols-outlined cartTrashIcon text_dn';
                cartTrashIcon.textContent = 'delete';

                const cartPlusSign = document.createElement('span');
                cartPlusSign.className = 'cartPlusSign text_dn';
                cartPlusSign.textContent = '\u002b';

                const cartPlusMinusDiv = document.createElement('div');
                cartPlusMinusDiv.className = 'cartPlusMinusDiv text_dn';

                 if(night){
                    cartMinusSign.style.color = "rgba(255, 255, 255,0.8)";
                    cartTrashIcon.style.color = "rgba(255, 255, 255,0.8)";
                    cartPlusSign.style.color = "rgba(255, 255, 255,0.8)";
                 }
                else{
                     cartMinusSign.style.color = "black";
                     cartTrashIcon.style.color = "black";
                     cartPlusSign.style.color = "black";
                }

                cartPlusMinusDiv.appendChild(cartMinusSign);
                cartPlusMinusDiv.appendChild(cartTrashIcon);
                cartPlusMinusDiv.appendChild(cartPlusSign);


                cartMinusSign.addEventListener('click', () => {

                    if (item.quantity === 1) {
                        clearFromCart(item.id);
                    } else {
                        --item.quantity;
                        if (isSpanish)
                            qtyP.textContent = `Cantidad: ${item.quantity}`;
                        else
                            qtyP.textContent = `Quantity: ${item.quantity}`;
                    }
                     updateTotal();
                });


                cartPlusSign.addEventListener('click', () => {

                    if (item.quantity < 3) {
                        ++item.quantity
                        if (isSpanish)
                            qtyP.textContent = `Cantidad: ${item.quantity}`;
                        else
                            qtyP.textContent = `Quantity: ${item.quantity}`;
                         updateTotal();  
                    }
                });

                cartTrashIcon.addEventListener('click', () => {                    
                    clearFromCart(item.id);
                });


                right.appendChild(nameP);
                right.appendChild(pane_size);
                right.appendChild(qtyP);
                right.appendChild(cartPlusMinusDiv);

                // Put it all together
                container.appendChild(left);
                container.appendChild(right);

                // Add to cart div
                cartDiv.appendChild(container);
            });

            updateTotal();

        }

    </script>

    <script>

        function closeQRWindow() {
            document.getElementById('qrcode-div-background-id').style.display = 'none';
            document.body.style.overflow = "";
        }


        function createQRLink() {

            let qr_str;

            if(DEBUG_MODE == DEBUG.NO)
                qr_str = 'https://samuelg900.github.io/ElsiliasKitchen/404.html#' + cart.length + '/';
            else
                qr_str = 'http://127.0.0.1:5500/home.html/#' + cart.length + '/';
            
            let pansize;

            cart.forEach(item => {

                if (item.pan_size == 1)
                    pansize = 'f';
                else
                    pansize = 'h';

                qr_str += String(item.id).padStart(5,'0') + pansize + item.quantity + '/';

            });
        // console.log(qr_str + '@');
            return qr_str += '@';

        }


        function getQRDateTime() {
            const date = new Date();
            document.getElementById('currentDateId').innerHTML = `${date.toDateString()} <br> ${date.toLocaleTimeString()}`;
        }   

        function checkoutBtnFunc() {

            //close message box if open
            if(document.getElementById("saveContainerId").classList.contains("show"))
                document.getElementById("saveContainerId").classList.toggle("show");

            if (cart.length === 0) return;

            document.getElementById('qrcode-div-background-id').style.display = 'block';

            document.getElementById("qrcode").innerHTML = '';

            new QRCode(document.getElementById("qrcode"), {
                text: createQRLink(),
                width: 200,
                height: 200,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });

            // #D25A21

            getQRDateTime();

            if(savedMessage != undefined){

                // const noteString = document.getElementById('p_for_saved_message').value;

                if (isSpanish){
                    if(savedMessage.length > 20){
                        document.getElementById('p_for_saved_message').innerHTML = `Nota:<br>${savedMessage.slice(0, 20)}...`;
                    }
                    else
                        document.getElementById('p_for_saved_message').innerHTML = `Nota:<br>${savedMessage}`;
                }
                else{
                    if(savedMessage.length > 20){
                        document.getElementById('p_for_saved_message').innerHTML = `Note:<br>${savedMessage.slice(0, 20)}...`;
                    }
                    else
                        document.getElementById('p_for_saved_message').innerHTML = `Note:<br>${savedMessage}`;
                }

                document.getElementById('p_for_saved_message').style="display:block; font-size:12px; font-style: italic; text-align: center; margin: 20px 20px; overflow-wrap: break-word; word-break: break-all";
            }
            else
                document.getElementById('p_for_saved_message').style.display='none';

            document.querySelector('.cart').classList.toggle('open');

            document.body.style.overflow = "hidden";
                 
        }
    </script>



    <style>
        .side_menu_div{
            display: flex;
            flex-direction: column;
            width: 0;
            height: 100%;
            position: fixed;
            min-height: 650px;
            top: 0;
            left:0;
            z-index: 11;
            background-color: white;
            box-shadow: 10px 0 10px -10px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            transition: width 0.6s ease, background-color 1s ease, box-shadow 0.6s ease;;
            /* border-right: 1px solid grey; */
        }

        .side_menu_div_shadowDay{
            box-shadow: 10px 0 10px -10px rgba(0, 0, 0, 0.5);
        }

        .side_menu_div_shadowNight{
            box-shadow: 10px 0 10px -10px rgba(255, 255, 255, 0.5);
        }


        .showMenu{
            width: 300px;
        }

        .side_menu_item{
            display: flex;
            position: relative;
            justify-content: center;
            /* width: 100%; */
            height: 80px;
            /* border-width: 0 0 1px 0;
            border-style: solid;
            border-color: rgba(163, 163, 163, 0.5); */
            align-items: center;
            overflow: hidden;

            border-radius: 10px;
            /* margin: 8px; */
            margin-inline: 10px;
            margin-block: 5px;
            transition: transform 1s ease;
        }

         .side_menu_item svg{
            transition: transform 0.6s ease;
         }

        .side_payment_div{
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            cursor: pointer;
        }

        .side_close_icon{
            position: absolute;
            top: 4px;
            left: 28px;
            margin: 0;
            font-size: 40px;
            cursor: pointer;
        }

        .side_svg:hover{
            transform: scale(1.2);
        }

        .side_svg{
            position: absolute;
            opacity: 0.5;
            
                width: 100%;
                z-index: 0;
        }
        .side_label{
            font-size: 18px;
            z-index: 1;
            /* font-weight: 600; */
            pointer-events: none;
        }

    </style>

<script>

    function toggleSideMenu(){
        document.getElementById('side_menu').classList.toggle('showMenu');

        if(document.getElementById('side_menu').classList.contains('showMenu'))
            document.body.style.overflow = "hidden";
        else
            document.body.style.overflow = "";
    }
</script>

<style>
    #payment_menu_id{
        /* width:0; */
        z-index: 12;
    }

    /* #payment_menu_id.show{
        width:250px;
    } */

    #payment_menu_div{
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-self: center;
    }

    #payment_menu_label{
        /* needed? */
        text-align: center;
        font-weight: 600;
        /* color: #008CFF;
        color: #00e013; */
    }

    #payment_menu_qr{
        border: 4px solid white;
    }

</style>

<script>

    function toggleBackMenu(){
        document.getElementById('payment_menu_id').classList.toggle('showMenu');
    }

    function openPaymentQR(item){
        
        if(document.getElementById('payment_id').classList.contains('showPayment')){
            if(document.getElementById("payment_label").textContent[0]==item)
                document.getElementById('payment_id').classList.toggle('showPayment');
        }
        else
            document.getElementById('payment_id').classList.toggle('showPayment');


        switch(item) {
            case "V":
                document.getElementById("payment_label").innerHTML=`<br><a style="color:#008CFF; font-style: italic; text-decoration:none; cursor:pointer;" href="https://venmo.com/code?user_id=3229643071029248311" target="_blank">VENMO &#8599;</a><br><p class="text_dn" style="font-weight:500;">@ElsiliaKitchen</p><br>`; 
                document.getElementById("payment_qr").innerHTML = '';

                new QRCode(document.getElementById("payment_qr"), {
                text: "https://venmo.com/code?user_id=3229643071029248311",
                width:200,
                height: 200,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });
                break;
            case "C":
                document.getElementById("payment_label").innerHTML=`<br><a style="color:#00E013; font-style: italic; text-decoration:none; cursor:pointer;" href="https://cash.app/$Elsamorel1?qr=1" target="_blank">CASH APP &#8599;</a><br><p class="text_dn" style="font-weight:500;">$Elsamorel1</p><br>`; 
                document.getElementById("payment_qr").innerHTML = '';

                new QRCode(document.getElementById("payment_qr"), {
                text: "https://cash.app/$Elsamorel1?qr=1",
                width: 200,
                height: 200,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });
                break;
            default:
                document.getElementById("payment_label").textContent="Nothing";
                break;
        }
    
    }

    function openPaymentQRMenu(item){
        // document.getElementById('payment_menu').classList.toggle('show');
        document.getElementById('payment_menu_id').classList.toggle('showMenu');
        
        switch(item) {
            case "V":
                document.getElementById("payment_menu_label").innerHTML=`<br><a style="color:#008CFF; text-decoration:none; cursor:pointer;" href="https://venmo.com/code?user_id=3229643071029248311" target="_blank">VENMO &#8599;</a><br><p class="text_dn" style="font-weight:500;">@ElsiliaKitchen</p><br>`; 
                
                document.getElementById("payment_menu_qr").innerHTML = '';

                new QRCode(document.getElementById("payment_menu_qr"), {
                text: "https://venmo.com/code?user_id=3229643071029248311",
                width:200,
                height: 200,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });
                break;
            case "C":
                document.getElementById("payment_menu_label").innerHTML=`<br><a style="color:#00E013; text-decoration:none; cursor:pointer;" href="https://cash.app/$Elsamorel1?qr=1" target="_blank">CASH APP &#8599;</a><br><p class="text_dn" style="font-weight:500;">$Elsamorel1</p><br>`; 
                document.getElementById("payment_menu_qr").innerHTML = '';

                new QRCode(document.getElementById("payment_menu_qr"), {
                text: "https://cash.app/$Elsamorel1?qr=1",
                width: 200,
                height: 200,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });
                break;
            default:
                document.getElementById("payment_menu_label").textContent="Nothing";
                break;
        }
    }
</script>

<style>
        .payment_id_div{
            display: flex;
            flex-direction: column;
            width: 300px;
            height: 0;
            position: fixed;
            top: 28px;
            right:6px;
            z-index: 10;
            background-color: white;
            overflow: hidden;
            transition: height 0.6s ease, padding-top 0.6s ease, background-color 1s ease;
            /* border-left: 1px solid grey;
            border-bottom: 1px solid grey; */
    border-radius: 0px 0px 16px 16px;
    box-shadow: -1px 0px 20px rgba(0, 0, 0, 0.3);
        }

        .payment_id_div svg{
            transition: transform 0.6s ease;
        }


        .payment_div{
            display: flex;
            justify-content: center;
            width: 90px;
            cursor: pointer;
        }

         #payment_menu_id{
        /* width:0; */
        z-index: 12;
    }

    /* showMenu */

    .showPayment{
        padding-top: 28px;
        height: 360px;
    }

    #payment_container{
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-self: center;
    }

    #payment_label{
        /* needed? */
        text-align: center;
        font-weight: 600;
        /* color: #008CFF;
        color: #00e013; */
    }

    #payment_qr{
        border: 4px solid white;
    }

</style>

<div id="payment_id" class="back_dn payment_id_div">
    
    <!-- <div class="payment_item">
         <span class="side_close_icon" onclick="toggleBackMenu()">&lt;</span>
    </div> -->

    <div id="payment_container">
        <a class="text_dn" id="payment_label"></a>
        <div id="payment_qr"></div>
    </div>

</div>


<div id="payment_menu_id" class="back_dn side_menu_div">
    
    <div class="side_menu_item">
        <!-- close icon -->
         <span style="top:14px" class="side_close_icon text_dn" onclick="toggleBackMenu()">&lt;</span>
    </div>

    <div id="payment_menu_div">
        <a class="text_dn" id="payment_menu_label"></a>
        <div id="payment_menu_qr"></div>
    </div>

</div>



<div id="side_menu" class="back_dn side_menu_div">

    
    <div class="side_menu_item">
        <!-- close icon -->
         <span style="top:14px" class="side_close_icon text_dn" onclick="toggleSideMenu()">&times;</span>

    </div>

 <!-- dark and light mode -->
    <div class="side_menu_item">
        <span class="container_slider_menu switch_dn" onclick="changeNightMode()">

            <span id="day_night_ball" class="ball_slider dn_slide"></span>
           <!-- day -->
            <span>
                <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="25" fill="#FFC300"/>

                <g stroke="#FFC300" stroke-width="7" stroke-linecap="round">
                    <line x1="50" y1="10" x2="50" y2="30"/>
                    <line x1="50" y1="70" x2="50" y2="90"/>
                    <line x1="10" y1="50" x2="30" y2="50"/>
                    <line x1="70" y1="50" x2="90" y2="50"/>
                    
                    <g transform="rotate(45 50 50)">
                        <line x1="50" y1="10" x2="50" y2="30"/>
                        <line x1="50" y1="70" x2="50" y2="90"/>
                        <line x1="10" y1="50" x2="30" y2="50"/>
                        <line x1="70" y1="50" x2="90" y2="50"/>
                    </g>
                </g>
                </svg>
            </span>

            <!-- night --> 
            <span>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="-2 -2 21 22">Â 
                    <path d="M15.78 14.09C14 14.84 12 14.84 10.21 14.1C8.43 13.37 7.01 11.95 6.27 10.16C5.52 8.37 5.52 6.36 6.26 4.56C6.99 2.77 8.4 1.35 10.18 0.6C10.45 0.48 10.42 0.14 10.13 0.09C8.6 -0.14 7.03 0.07 5.6 0.71C4.5 1.16 3.5 1.81 2.66 2.65C1.81 3.49 1.14 4.48 0.69 5.58C0.23 6.68 -0 7.86 0 9.05C0 10.25 0.24 11.42 0.7 12.52C1.16 13.62 1.84 14.61 2.69 15.44C3.53 16.28 4.54 16.93 5.64 17.37C6.74 17.81 7.92 18.02 9.11 18C10.29 17.97 11.46 17.71 12.55 17.23C13.98 16.65 15.23 15.68 16.14 14.45C16.29 14.24 16.01 13.97 15.78 14.09Z" fill="grey"/>Â 
                </svg>
            </span>

        </span>
    </div>
                <!-- venmo -->
    <div class="side_menu_item" onclick='openPaymentQRMenu("V")'>
        <div class="side_payment_div">
            <svg xmlns="http://www.w3.org/2000/svg" class="side_svg" viewBox="0 0 512 512">
                <path d="M381.4 105.3c11 18.1 15.9 36.7 15.9 60.3 0 75.1-64.1 172.7-116.2 241.2H162.3l-47.6-285 104.1-9.9 25.3 202.8c23.5-38.4 52.6-98.7 52.6-139.7 0-22.5-3.9-37.8-9.9-50.4z" fill="#008CFF"/>
            </svg>    
            
            <span class="text_dn side_label">VENMO</span>
        </div>     
    </div>

            <!-- cashapp -->
    <div class="side_menu_item" onclick='openPaymentQRMenu("C")'>
        <div class="side_payment_div">
            <svg xmlns="http://www.w3.org/2000/svg" class="side_svg" viewBox="0 0 210 210" fill="none">
                <rect width="150" height="150" x="25" y="25" rx="7.81424" fill="#fff"/>
                <path fill="#00E013" d="M206.398,30.286c-4.502-12.394-14.307-22.189-26.713-26.687C168.48,0,158.075,0,136.865,0h-63.63c-21.11,0-31.615,0-42.92,3.498C17.909,7.996,8.104,17.792,3.602,30.186C0,41.58,0,52.075,0,73.165v63.57c0,21.19,0,31.585,3.502,42.98c4.502,12.394,14.307,22.189,26.713,26.687C41.62,210,52.125,210,73.135,210h63.63c21.11,0,31.615,0,42.92-3.598c12.406-4.498,22.211-14.293,26.713-26.687C210,168.32,210,157.825,210,136.735v-63.47C210,52.175,210,41.68,206.398,30.286z M151.472,71.866l-12.106,9.895c-1.101,0.9-2.601,0.7-3.402-0.4c-6.203-7.596-15.807-11.894-26.312-11.894c-11.706,0-19.009,5.098-19.009,12.294c-0.2,6.097,5.503,9.196,23.011,12.994c22.111,4.698,32.215,13.893,32.215,29.386c0,19.391-15.808,33.684-40.519,35.283l-2.401,11.495c-0.2,1.099-1.201,1.899-2.401,1.899H81.539c-1.601,0-2.701-1.499-2.401-2.999l3.001-12.794c-12.206-3.498-22.111-10.295-27.813-18.591c-0.7-1.099-0.5-2.499,0.5-3.298l13.206-10.395c1.101-0.9,2.701-0.6,3.502,0.5c7.003,9.795,17.808,15.593,30.815,15.593c11.706,0,20.51-5.697,20.51-13.893c0-6.297-4.402-9.196-19.309-12.294c-25.412-5.497-35.517-14.793-35.517-30.286c0-17.991,15.107-31.485,37.918-33.284l2.501-11.894c0.2-1.099,1.201-1.899,2.401-1.899h18.709c1.501,0,2.701,1.399,2.401,2.899l-2.901,13.294c9.805,2.999,17.808,8.396,22.811,15.093C152.673,69.567,152.473,71.066,151.472,71.866z"/>
            </svg>
            
                <span class="text_dn side_label">CASH APP</span>
        </div>
    </div>

        <style>
            .container_slider{
                display: flex;
                justify-content: space-around;
                width: 65px;
                height: 32px;
                border-radius: 40px;
                background-color: rgb(47, 47, 47);
                cursor: pointer; 
                margin: 13px;
            }

            .container_slider .ball_slider{
                height: 27px;
                width: 27px;
                margin: 3px;
            }

            .container_slider #usa_dr_ball{
                transform: translateX(-16px);
                 background: rgb(151, 224, 43);
            }

            .container_slider #usa_dr_ball.changeLang{
                transform: translateX(16px);
            }

            .container_slider #day_night_ball{
                transform: translateX(-16px);
                 background: lightblue;
            }

            .container_slider #day_night_ball.changeNight{
                transform: translateX(16px);
            }

            .container_slider svg{
                height:80%;
                margin: 3.5px;
            }
            

             .container_slider img{
                border-radius: 2px;
                height: 45%;
                margin-inline: auto;
                /* z-index: 1; */
            }

            .container_slider_menu{
                display: flex;
                justify-content: space-around;
                width: 115px;
                height: 70%;
                border-radius: 40px;
                background-color: #606060;
                 cursor: pointer;
            }
            
            .container_slider_menu svg{
                height: 80%;
                margin: 5px;
            }
            .container_slider_menu img{
                border-radius: 5px;
                height: 46%;
                margin-inline: auto;
                /* z-index: 1; */
            }

            .flag_span{
                display: flex;
                align-items: center;
            }

            .ball_slider{
                 position: absolute;
                /* transform: translateX(-30px); */
                height: 48px;
                width: 48px;
                 /* background: lightblue; */
                 border-radius: 50px;
                 margin: 4px;
                transition: transform 0.5s ease;
            }

            #usa_dr_ball{
                transform: translateX(-30px);
                 background: rgb(151, 224, 43);
            }

            #usa_dr_ball.changeLang{
                transform: translateX(30px);
            }

            #day_night_ball{
                transform: translateX(-30px);
                 background: lightblue;
            }

            #day_night_ball.changeNight{
                transform: translateX(30px);
            }

        </style>

   
    <!-- translate -->
    <div class="side_menu_item">
        <span class="container_slider_menu switch_dn" onclick="changeLanguage()">
            <span id="usa_dr_ball" class="ball_slider lang_slide"></span>
            <span class="flag_span"> <img src="USA_flag.png"> </span>
            <span class="flag_span"> <img src="DR_flag.png"> </span>
        </span>
    </div>
    <style>
    .side_logo{
        display: flex;
        position: absolute;
        bottom: 20px;
        /* margin-top: 70%; */
        left: 50%;
        right:50%;
        margin-inline: -40px;
        transform: (50%,50%);
        
    }

    .side_logo svg{
        width: 60px;
        height: 60px;
    }
            
    </style>


     <div class="side_logo">
            <!-- E -->
            <svg id="ee" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                
                <path stroke="var(--primary-dark)" stroke-width="5" fill="white"
                    d="M10,40 A30,30 0 0 1 40,10 L90,10 L90,30 L40,30 A10,10 0 0 0 30,40 L85,40 L85,60 L30,60 A10,10 0 0 0 40,70 L90,70 L90,90 L40,90 A30,30 0 0 1 10,60 Z" />
            </svg>
                <!-- K -->
            <svg id="kk" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <polygon points="10,10 30,10 30,40 40,40 65,10 91,10 55,50 91,90 65,90 40,60 30,60 30,90 10,90"
                    stroke="var(--primary-dark)" stroke-width="5" fill="white"></polygon>
            </svg>

        </div>

</div>



        <style>
            /* .divl{
               align-self: center;
            } */
            
            .divm{
                display: flex;
                height: 76px;
                width: 76px;
                position: absolute;
                left: 50%;
                right:50%;
                margin-left: -40px;
                transform: (-50%,-50%);
            }

            .divr{
                display: flex;
                align-items: center;
                gap: 16px;
            }

            #cir_nav{
                display: flex;
                /* flex-wrap: wrap; */
                justify-content: space-between;
                flex: 1 1 auto; 
                align-items: center;
                position: fixed;
                /* padding-inline: 64px; */
                top: 10px;
                left: 10px;
                right: 10px;
                height: 52px;
                border-radius: 50px;
                min-width: 380px;
                background-color: inherit;

                /* border: 2px solid darkslategray;
                border-top: 0; */
            }
            
            .cir_nav_shadowDay{
                box-shadow: 0 1px 3px 0 rgba(0, 0, 0, .12), 0 4px 8px 0 rgba(0, 0, 0, .12);
                transition: box-shadow 0.5s ease;
            }

             .cir_nav_shadowNight{
                box-shadow: 0 1px 3px 0 rgba(255, 255, 255, .12), 0 4px 8px 0 rgba(255, 255, 255, .12);
                transition: box-shadow 0.5s ease;
            }

            #id_cashapp, #id_venmo{
                padding: 20px 0px;
                font-size: 15px;
                font-weight: 900;
                font-style: italic; 
                transition: color 1s ease;
                cursor: pointer;
            }

            #id_cashapp:hover{
                color: #00E013 !important;
            /* background: #00e01390; */
            }

            #id_venmo:hover{
                color: #008CFF !important;
            /* background: #008CFF90; */
            }
               
        </style>

<div class="back_dn shadow_dn" id="top_nav">
    <div id="cir_nav">

        <style>
            .divl{
                display: flex;
                align-items: center;
            }

            .menu_icon{
                display: none;
                font-size: 30px;
                margin: 0 20px 0 18px;
                cursor: pointer;
            }


            .languageContainerrr{ 
    position: relative;    
    margin: 13px;
    width: 90px;
    /* height: 24px; */
    /* z-index: 999; */
}

.languageContainerrr img{
    position: absolute;
    margin: auto;
    height: 20px;
    z-index: 1;
}

            @media (max-width: 800px) {
                .menu_icon{
                    display: block;
                }

                .languageContainer{
                    display: none;
                }

                .container_slider{
                    display: none;
                }

                .payment_div{
                    display: none;
                }

                        .switchLanguage{
    aspect-ratio: 2.4/1;
}

    .usa{
    left: 8px;
    top:25%;
    border-radius: 3px;
}

.dr{
    right: 8px;
    top:25%;
    border-radius: 3px;
}

        .switchBall.changeToSpanish{
    transform: translateX(101%);
    }
            }

        </style>



        <div class="divl">

            <span class="material-symbols-outlined menu_icon text_dn" onclick="toggleSideMenu()">menu</span>

            <!-- <div class="languageContainer">
                <div class="switchLanguage" onclick="changeLanguage()">
                    <img class="usa" src="USA_flag.png">
                    <div class="switchBall" id="ball_id"></div>
                    <img class="dr" src="DR_flag.png">
                </div>
            </div> -->

            <span class="container_slider switch_dn" onclick="changeLanguage()">
                <span id="usa_dr_ball" class="ball_slider lang_slide"></span>
                <span class="flag_span"> <img src="USA_flag.png"> </span>
                <span class="flag_span"> <img src="DR_flag.png"> </span>
            </span>

            <span class="container_slider switch_dn" onclick="changeNightMode()">

                <span id="day_night_ball" class="ball_slider dn_slide"></span>
                
                <!-- day -->
                <span>
                    <svg viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="50" cy="50" r="25" fill="#FFC300"/>

                        <g stroke="#FFC300" stroke-width="7" stroke-linecap="round">
                            <line x1="50" y1="10" x2="50" y2="30"/>
                            <line x1="50" y1="70" x2="50" y2="90"/>
                            <line x1="10" y1="50" x2="30" y2="50"/>
                            <line x1="70" y1="50" x2="90" y2="50"/>
                            
                            <g transform="rotate(45 50 50)">
                                <line x1="50" y1="10" x2="50" y2="30"/>
                                <line x1="50" y1="70" x2="50" y2="90"/>
                                <line x1="10" y1="50" x2="30" y2="50"/>
                                <line x1="70" y1="50" x2="90" y2="50"/>
                            </g>
                        </g>
                    </svg>
                </span>
                
                <!-- night --> 
                <span>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="-2 -2 21 22">Â 
                        <path d="M15.78 14.09C14 14.84 12 14.84 10.21 14.1C8.43 13.37 7.01 11.95 6.27 10.16C5.52 8.37 5.52 6.36 6.26 4.56C6.99 2.77 8.4 1.35 10.18 0.6C10.45 0.48 10.42 0.14 10.13 0.09C8.6 -0.14 7.03 0.07 5.6 0.71C4.5 1.16 3.5 1.81 2.66 2.65C1.81 3.49 1.14 4.48 0.69 5.58C0.23 6.68 -0 7.86 0 9.05C0 10.25 0.24 11.42 0.7 12.52C1.16 13.62 1.84 14.61 2.69 15.44C3.53 16.28 4.54 16.93 5.64 17.37C6.74 17.81 7.92 18.02 9.11 18C10.29 17.97 11.46 17.71 12.55 17.23C13.98 16.65 15.23 15.68 16.14 14.45C16.29 14.24 16.01 13.97 15.78 14.09Z" fill="grey"/>Â 
                    </svg>
                </span>
            </span>

        </div>

        <div class="divm">
            <!-- E -->
            <svg id="ee" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                
                <path stroke="var(--primary-dark)" stroke-width="5" fill="white"
                    d="M10,40 A30,30 0 0 1 40,10 L90,10 L90,30 L40,30 A10,10 0 0 0 30,40 L85,40 L85,60 L30,60 A10,10 0 0 0 40,70 L90,70 L90,90 L40,90 A30,30 0 0 1 10,60 Z" />
            </svg>
                <!-- K -->
            <svg id="kk" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <polygon points="10,10 30,10 30,40 40,40 65,10 91,10 55,50 91,90 65,90 40,60 30,60 30,90 10,90"
                    stroke="var(--primary-dark)" stroke-width="5" fill="white"></polygon>
            </svg>

        </div>

        <div class="divr">

                            <!-- venmo -->
        <div id="id_venmo" class="payment_div text_dn" onclick="openPaymentQR('V')">
            <span>VENMO</span>
        </div>

            <!-- cashapp -->
        <div id="id_cashapp" class="payment_div text_dn" onclick="openPaymentQR('C')">           
            <span>CASH APP</span>
        </div>
            <div id="cart_num_id">0</div>
            <span class="material-symbols-outlined cart_icon" onclick="openCartContents()">shopping_cart</span>
        </div>
    </div>
</div>

    <div class="cart" id="cart_contents_id">
        <div class="back_dn cartContent">
            <div class="text_dn" id="nothing_in_cart">Cart is empty</div>
            <div class="cartItems" id="cartItemsId">
        </div>
            <div class="back_dn checkout_div">
                <p class="text_dn" id="total_of_order_id">Total: $0</p>
                <a class="text_dn" id="add_message" onclick="openAddMessage(2)">Add message...</a>
                <button id="checkoutBtn" onclick="checkoutBtnFunc()">Checkout</button>
            </div>
        </div>

        <div id="saveContainerId">
            <textarea id="textareaId" placeholder="Add food details if needed..." rows="2" cols="40"></textarea>
            <div class="save_div">
                <button id="cancelMessageButtonId" type="button" onclick="openAddMessage(0)">Cancel</button>
                <p id="labelId" style="color: white;">0/200</p>
                <button id="saveMessageButtonId" onclick="saveAddedMessage()" type="button">Save</button>
            </div>
        </div>
        
    </div>

    <div class="banner">
        
        <style>

            .banner_con{
                position: relative;
                top: 0;
                left: 0;
                height: 40px;
                background-color: black;
                border-top: 6px solid rgb(255, 208, 0);
            }

            .scrollText{
                color: rgb(255, 208, 0);
                line-height: 40px; 
                font-size: 1.6em;
                letter-spacing: 2px;   
                word-spacing: 2px; 
            }

            .scrollText a{
                font-size: 0.8em;
            }

        </style>

<!-- START -->

 <div class="banner_con">
        <!-- the marquee element is deprecated but I'll still use it for this -->
        <marquee class="scrollText" direction="left">Thank you for checking us out <a>ðŸ¥°</a> We're not currently taking orders at this time <a>ðŸ˜¢</a> Feel free to browse around and check out the foods we have to offer <a>ðŸ˜¯</a> Ordering with us starts in 2026! <a>ðŸ˜Š</a></marquee>
 </div>

<!-- END -->
        <img src="banner.png">
        <div class="p_container">
            <p class="syncopate-bold">Elsilia's<br>Kitchen</p>
            <p class="caveat">Delicious Dominican food,<br>from our home to yours</p>
           </div> 
           <div class="location">
            
                <span class="material-symbols-outlined">map_pin_heart</span> 
               <p> Manchester, NH </p>
            </div>
           </div>
                <!-- <p class="location"> -->
    <!-- </div> -->

    <style>
        .location{
            display: flex;
            flex-direction: row;
            align-items: center;
            position: absolute;
            padding-inline: 2px;
            padding-block: 2px;
            /* font-size: 8px; */
            right:5px;
            bottom: 6px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 20px;
            box-shadow: 1px 1px 3px rgba(44, 44, 44, 0.716);
        }

        .location p{
            margin: 1px 2px;
            /* color: black; */
            font-size: 0.9rem;
        }   

        .location span{
            /* padding-top: .5px; */
            font-size: 1rem;
            color: black;
        }

        @media screen and (max-width: 600px){
            
        .location p{
            font-size: 0.5rem;
        }   

        .location span{
            font-size: .9rem;
        }

            
    }
    </style>

    <script>
        let numOfOrders = 0;
        let orderTotal = 0;
    </script>



    <div class="body_content">

        <div id="image_viewer_window">
            <img class="image_viewer" src="">
            <div class="image_icon_container">
                <span class="close_icon" onclick="closeImageViewer()" alt="close">&times;</span>
            </div>
        </div>

        <script>
            function closeImageViewer() {
                document.getElementById('image_viewer_window').style.display = 'none';
            }

            function openImageViewer(imageSrc) {
                document.querySelector('.image_viewer').src = imageSrc;
                document.getElementById('image_viewer_window').style.display = 'block';
            }

            window.addEventListener('keydown', function (event) {

                // Example: Close modal with Escape key
                if (event.key === 'Escape') {
                    if (document.getElementById('image_viewer_window').style.display === 'block') {
                        document.getElementById('image_viewer_window').style.display = 'none';
                    }
                }
            });

        const header = document.getElementById('cir_nav');
        const headerTop = header.offsetTop; // original top position
        window.addEventListener('scroll', () => {
            
        if (window.scrollY > headerTop) {
            if(night){
                header.classList.remove('cir_nav_shadowDay');
                header.classList.add('cir_nav_shadowNight');
            }
            else{
                header.classList.remove('cir_nav_shadowNight');
                header.classList.add('cir_nav_shadowDay');
            }

        } else {
            if(night)
                header.classList.remove('cir_nav_shadowNight');
            else
                header.classList.remove('cir_nav_shadowDay');

        }
        });


        </script>

        <div class="menu" id="menu">
            <section class="category">
                <h1 class="text_dn" id="title_rice_id">Rice</h1>
                <div class="tempContainer" id="menu-arroz"></div>
            </section>

            <section class="category">
                <h1 class="text_dn" id="title_meats_id">Meats</h1>
                <div class="tempContainer" id="menu-carne"></div>
            </section>

            <section class="category">
                <h1 class="text_dn" id="title_pasta_id">Pastas & Salads</h1>
                <div class="tempContainer" id="menu-pasta"></div>
            </section>

            <section class="category">
                <h1 class="text_dn" id="title_roots_id">Roots</h1>
                <div class="tempContainer" id="menu-viveres"></div>
            </section>

            <section class="category">
                <h1 class="text_dn" id="title_fingerfood_id">Finger Food</h1>
                <div class="tempContainer" id="menu-picadera"></div>
            </section>

             <section class="category">
                <h1 class="text_dn" id="title_pasteles_id">Pasteles</h1>
                <div class="tempContainer" id="menu-pasteles"></div>
            </section>

        </div>

        <script>

  function scrollFunc(menu_id){
    
    hidePieTitleSelector();

    const elementPosition = document.getElementById(menu_id).getBoundingClientRect().top + window.scrollY;
    const offsetPosition = elementPosition - 80;

    window.scrollTo({
        top: offsetPosition
    });

  }

        </script>
        
            <div id="pie_container"></div>

<script>
              const navigation_pie = document.getElementById('pie_container');
let timeout;

// 1. SCROLL LISTENER (Modified slightly)
window.addEventListener('scroll', () => {
    
    //resets current timeouts set
    clearTimeout(timeout);
    navigation_pie.classList.add('active');            
    
    timeout =  setTimeout(() => {
        //stay open for a second
     hidePieTitleSelector();
    
    console.log('Scroll timeout - Hiding after 1 sec');
      }, 1000);

});



// 2. MOUSE ENTER/LEAVE (For desktop)
navigation_pie.addEventListener('mouseenter', () => {
    clearTimeout(timeout);
    // console.log(3);
    console.log('Mouse Enter - Keeping visible');
});

navigation_pie.addEventListener('mouseleave', () => {
    // Only start a hide timer if a touch hasn't kept it active
        timeout = setTimeout(() => {
            hidePieTitleSelector();
            // console.log(4);
            
    console.log('Mouse Leave - Hiding after short delay');
        }, 100);
});

</script>

<style>

    #nav_circle_id{
        cursor: pointer;
    }


    .pie_group{
        display: none;
        /* opacity: 0; */
    }

    .pie_group.show{
        display: block;
        /* opacity: 1; */
    }

    .slice {
        display: none;
            transition: transform 0.3s ease-out;
            opacity: 0.9;
        }
        .slice:hover {
            transform: scale(1.02);
            opacity: 1;
            filter: drop-shadow(0 0 1px rgba(255, 255, 255, 0.3));
            cursor: pointer;
        }
    #pie_container{ 
        position: fixed;
        top:25%;
        /* top:40vh; */

        right:-170px;
        width: 300px;
        height: 300px;
        /* transform: translate(0, -50%); */
        transition: right 0.3s ease;  
        display: block;
    }

     #pie_container.active {
            pointer-events: auto;
            right:-140px;
        }

      


</style>

<script>
const titlesArray = {
  titles: ["title_pasteles_id", "title_fingerfood_id", "title_roots_id", "title_pasta_id", "title_meats_id", "title_rice_id"],
  names: ["Pasteles", "Finger Food", "Roots", "Salads", "Meats", "Rice"]
}

function hidePieTitleSelector(){
    document.querySelectorAll('.pie_group').forEach(item => item.classList.remove('show'));
    document.getElementById('pie_container').classList.remove('active');
    document.getElementById('pie_container').style.zIndex='1';
}

function addInteractivity(svg) {
         

        const menu = svg.querySelectorAll('.pie_group');
        const circle = svg.getElementById('nav_circle_id');
        
        svg.querySelectorAll('.slice').forEach(slice => {
                slice.addEventListener('click', (e) => {
                    const titleID = e.target.getAttribute('data-id');
                    scrollFunc(titleID);
                    //  menu.forEach(item => item.classList.remove('show'));
                     hidePieTitleSelector();
                    //  document.getElementById('pie_container').style.zIndex='1';
                });
        });
        // Click or touch to toggle
        circle.addEventListener('click', () => {

                  menu.forEach(item => item.classList.toggle('show'));
                  clearTimeout(timeout);

            if(document.getElementById('pie_container').style.zIndex=='9')
                hidePieTitleSelector();
            else{
                document.getElementById('pie_container').style.zIndex='9'
            }

        });

        }

function createHalfDonutPie(labels, names, options = {}) {
  const size = options.size || 200;
  const gap = options.gap || 2; // degrees between slices
  const innerRadiusRatio = options.innerRadiusRatio || 0.6;
  const radius = size / 2.05;
  const innerRadius = radius * innerRadiusRatio;

  const svgNS = "http://www.w3.org/2000/svg";
  const svg = document.createElementNS(svgNS, "svg");
  svg.setAttribute("viewBox", `0 0 ${size} ${size}`);
  svg.style.transform = "rotate(180deg)"; // makes flat side on the left

  const sliceCount = labels.length;
  const sliceAngle = 180 / sliceCount; // divide half circle evenly

  let index=0;
  let currentAngle = 0;

  const toRadians = (angleDeg) => angleDeg * (Math.PI / 180);


    const getCoordinates = (angleDeg, radius) => {
            // Adjust angle so 0 degrees is at 12 o'clock (top of the circle)
            const adjustedAngleDeg = angleDeg - 90;
            const angleRad = toRadians(adjustedAngleDeg);
            return {
                x: radius * Math.cos(angleRad),
                y: radius * Math.sin(angleRad)
            };
        };

  labels.forEach((title_id, i) => {
    const startAngle = currentAngle + gap / 2;
    const endAngle = startAngle + sliceAngle - gap;

    const path = document.createElementNS(svgNS, "path");
    path.setAttribute("d", describeArc(radius, radius, radius, innerRadius, startAngle, endAngle));
    path.setAttribute("fill", "white");
    path.setAttribute("data-id", title_id);
    path.classList.add("slice");
    path.classList.add("pie_group");

    svg.appendChild(path);

    const midAngle = (startAngle + endAngle) / 2;

  // Midpoint position for text
    const textPos = polarToCartesian(
      radius,
      radius,
      (radius + innerRadius) / 2,
      midAngle
    );

    // Text element
    const text = document.createElementNS(svgNS, "text");
    text.setAttribute("x", textPos.x);
    text.setAttribute("y", textPos.y);
    text.setAttribute("fill", "black");
    text.setAttribute("font-size", "5.5");
    text.setAttribute("text-anchor", "middle");
    text.setAttribute("alignment-baseline", "middle");
    text.setAttribute("alignment-baseline", "middle");
    text.setAttribute("pointer-events", "none");
    text.classList.add("pie_group");
    text.textContent = names[index++];

     const textRadius = (radius + innerRadius) / 2;

      // Keep text upright when on the lower half (so it doesn't flip upside-down)
    let rotation = midAngle;
    if (rotation > 90 && rotation < 270) rotation += 180;


// pick the end of the slice line (outer arc)
  let rotationAngle = midAngle - 270;

    // If the mid-angle is in the lower half (180 to 270), flip the text by 180 degrees
    // to ensure it reads upright from the inner radius outwards.
    if (midAngle > 180 && midAngle < 270) {
        rotationAngle += 180;
    }

    text.setAttribute("transform", `rotate(${rotationAngle}, ${textPos.x}, ${textPos.y})`);
        
    svg.appendChild(text);

    currentAngle += sliceAngle;
  });

    const square = document.createElementNS(svgNS, "polygon");

    const topleft = `${size/2.05},${size/2.05+6}`;
    const topright = `${size/2.05-8},${size/2.05+6}`;
    const bottomright = `${size/2.05-8},${size/2.05-6}`;
    const bottomleft = `${size/2.05},${size/2.05-6}`;

    square.setAttribute("points",`${topleft} ${topright} ${bottomright} ${bottomleft}`);
    square.setAttribute('fill', '#202020');
    square.setAttribute('stroke', 'none');

    svg.appendChild(square);

    const circle = document.createElementNS(svgNS, "circle");
    circle.setAttribute('cx', size/2.05);
    circle.setAttribute('cy', size/2.05);
    circle.setAttribute('r', 6);
    circle.setAttribute('fill', '#202020');
    circle.setAttribute('id', 'nav_circle_id');

    svg.appendChild(circle);

    for (let i = 0; i < 4; i++) {
        const rect = document.createElementNS(svgNS, "rect");
        rect.setAttribute("x", 42);      
        rect.setAttribute("y", 45.3 + i*2);
        rect.setAttribute("width", 10);
        rect.setAttribute("height", 0.7); 
        rect.setAttribute("fill", "white");
        rect.setAttribute("pointer-events", "none");
        svg.appendChild(rect);
    }
 
    addInteractivity(svg);

  return svg;
}

// Helpers
function polarToCartesian(cx, cy, r, angle) {
  const rad = (angle - 90) * Math.PI / 180.0;
  return { x: cx + r * Math.cos(rad), y: cy + r * Math.sin(rad) };
}

function describeArc(cx, cy, outerR, innerR, startAngle, endAngle) {
  const startOuter = polarToCartesian(cx, cy, outerR, endAngle);
  const endOuter = polarToCartesian(cx, cy, outerR, startAngle);
  const startInner = polarToCartesian(cx, cy, innerR, startAngle);
  const endInner = polarToCartesian(cx, cy, innerR, endAngle);
  const largeArcFlag = endAngle - startAngle <= 180 ? "0" : "1";

  return [
    "M", startOuter.x, startOuter.y,
    "A", outerR, outerR, 0, largeArcFlag, 0, endOuter.x, endOuter.y,
    "L", startInner.x, startInner.y,
    "A", innerR, innerR, 0, largeArcFlag, 0, endInner.x, endInner.y,
    "Z"
  ].join(" ");
  
}

// --- Create and append pie ---
const pie = createHalfDonutPie(titlesArray.titles, titlesArray.names, { size: 100, gap: 2, innerRadiusRatio: 0.2 });
document.getElementById("pie_container").appendChild(pie);
</script>


    <style>

        #scrill_div_Id.active {
            opacity: 1;
            pointer-events: auto;
        }
        
        .scroll_spacer{
            display: flex;
            flex-direction: column;            
            background-color: white;
            width: 10px;
            height: 10px;
            margin: 0;
            border-radius: 50%;
            box-shadow: 1px 1px 8px rgba(0, 0, 0, 0.3);

        }
        .scroll_spacer:hover{
            transform: scale(1.2);
        }

        .scroll_item{
            display: flex;
            justify-content: center;
            align-items: center;  
            background-color: white;
            width: 10px;
            height: 40px;
            border-radius: 5px 0 0 5px;  
            box-shadow: 1px 1px 8px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            overflow: hidden;
            transition: width 0.5s;
        }

        .scroll_item:hover{
            width: 80px;
            transition: width 0.5s;
        }

        .scroll_item:active{
            width: 120px;
        }
    </style>


    <!-- =============== -->


        <script>
            getJsonData();



            let copyTimeout;

            function copyToClipboard(){
                
                let linkText="";
                let str = ""; 
                if (isSpanish){
                    if(savedMessage != undefined)
                        linkText = savedMessage.length > 0 ? "\nNota: " + savedMessage : "";

                    str ="Enlace de pedido: " + createQRLink() + linkText;
                }
                else{
                    
                    if(savedMessage != undefined)
                        linkText = savedMessage.length > 0 ? "\nNote: " + savedMessage : "";
                    
                        str ="Order link: " + createQRLink() + linkText;
                }
                // createQRLink() + linkText;
                
                console.log(str);
                
                // item.pan_size == 2 ? "Half Dozen" : "Dozen";
                navigator.clipboard.writeText(str)
                .then(() => {
                // alert("Copied the text: " + str);
                document.getElementById("copyNotificationId").classList.add('opac');

                clearTimeout(copyTimeout);
                // TODO: set timer to some variable and check if copy button is clicked again
                  // Hide the notification after 2 seconds
                copyTimeout = setTimeout(() => {
                    document.getElementById("copyNotificationId").classList.remove('opac');

                }, 2000);
                
            })
                .catch(err => {
                console.error('Failed to copy text: ', err);
                });

            }
        </script>

        <p  class="text_dn disclaimerText" id="size_disclaimerTextId">Each whole pan is enough for approximately 35-38 people</p>
        
        <div  class="text_dn disclaimerText" id="ai_disclaimerTextId" style="font-size: 13px;">For transparency: This site used AI imaging for the images seen on the page. If you'd like to see some of the cropped original images used as a reference, please click <a href="original_images.html" target="_blank">here</a></div>

        <div id="qrcode-div-background-id">
            <div class="back_dn text_dn" id="qrcode-div-id">
                <span id="currentDateId"></span>
                <span class="text_dn close_qrcode_window" onclick="closeQRWindow()">&times;</span>
                <h1 id="qrTitleId">Elsilia's Kitchen Order</h1>
                <div style="border: 4px solid white;" id="qrcode"></div>
                <p id="qrTextId">Please copy order link below or save this QR code and send it to <strong>Elsa</strong> to get order confirmation and set up an order date</p>
                    <!-- Por favor copia el enlace del pedido abajo o guarda este cÃ³digo QR y envÃ­aselo a Elsa para recibir la confirmaciÃ³n del pedido y programar una fecha</p> -->
                    <!-- Copy link below or save QR code and send to <strong>Elsa</strong> for confirm your order and set up order
                    date -->
                <p id="p_for_saved_message" style="display:none"></p>
                <button id="save-qr-button" onclick="generatePdf()">Save QR Code</button>
                <button id="save-order-link-button" onclick="copyToClipboard()">Copy Link</button>
                <div id="copyNotificationId">Link copied successfully!</div>
            </div>
        </div>
    </div>

    <div class="footer">
        <!-- <h1>123</h1> -->
    </div>

    <script>

        let savedMessage = undefined;

        function openAddMessage(option){

            //cancel
            if(option == 0) {
                document.getElementById("saveContainerId").classList.toggle("show");
            }
            //save
            else if(option == 1) {
                if(document.getElementById("textareaId").value.length > 0)
                    savedMessage = document.getElementById("textareaId").value;
                else
                    savedMessage = undefined;
                document.getElementById("saveContainerId").classList.toggle("show");
            }
            //add message clicked
            else {//option == 2
                if(savedMessage != undefined){
                   document.getElementById("textareaId").value = savedMessage;
                }
                document.getElementById("saveContainerId").classList.toggle("show");
            }
        
        }

        function saveAddedMessage(){

            const message = document.getElementById("textareaId").value;

            if(message.length > 0){
                savedMessage = message;
                document.getElementById("add_message").style.color="#4091ee";
            }
            else{
                savedMessage = undefined;
                if(night)
                    document.getElementById("add_message").style.color="rgba( 255, 255, 255,0.8)";
                else
                    document.getElementById("add_message").style.color="black";
            }
            openAddMessage(1);
        }

        const countLabel = document.getElementById("textareaId");
        countLabel.addEventListener('input', function(event) {
            
            if(event.target.textLength == 0)
                savedMessage = undefined;

            if(event.target.textLength > 200) 
                event.target.value = event.target.value.substring(0, 200);

            document.getElementById("labelId").textContent=`${event.target.textLength}/200`;
        });

    </script>

</body>

</html>
